{"componentChunkName":"component---src-templates-post-template-js","path":"/posts/nepse-market-cap","result":{"data":{"markdownRemark":{"id":"5d372f6c-15a3-53b3-9546-d8bee19e7eb8","html":"<p><img src=\"/media/nepse.png\" alt=\"NEPSE: Market Cap Vs Sectors&#x22;\"></p>\n<p>Best treat of boring data wrangling process is beautiful visualization that tells the whole story in single glance.<br>\nOn last <a href=\"https://rpy3.blogspot.com/2017/10/scraping-nepse-nepal-stock-market.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">NEPSE tutorial</a>, we scraped the company detail and daily stock price from 2010 to 2017. In this tutorial we will be using company detail data to make the above beautiful visualization. I have chosen swarmplot on sectors vs market capital. I like swarmplot as its gives information about distribution and number of data point on same plot.<br>\nWe will be using matplotlib and seaborn packages in python.  </p>\n<p>You can download data from <a href=\"https://github.com/BkrmDahal/nepse\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">github/bkrmdahal/nepse</a>.  </p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token triple-quoted-string string\">\"\"\"Import Required packages\"\"\"</span>\n<span class=\"token keyword\">import</span> pandas <span class=\"token keyword\">as</span> pd\n<span class=\"token keyword\">from</span> matplotlib <span class=\"token keyword\">import</span> pyplot <span class=\"token keyword\">as</span> plt\n<span class=\"token keyword\">import</span> seaborn <span class=\"token keyword\">as</span> sns\n<span class=\"token keyword\">import</span> numpy <span class=\"token keyword\">as</span> np\n<span class=\"token keyword\">import</span> matplotlib<span class=\"token punctuation\">.</span>style <span class=\"token keyword\">as</span> style\n\n<span class=\"token keyword\">from</span> util_nepse <span class=\"token keyword\">import</span> clean_names <span class=\"token comment\">#get if from my github nepse </span>\n\n<span class=\"token comment\">#set up style</span>\nstyle<span class=\"token punctuation\">.</span>use<span class=\"token punctuation\">(</span><span class=\"token string\">'fivethirtyeight'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">#read dataset</span>\ndf <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>read_csv<span class=\"token punctuation\">(</span><span class=\"token string\">'company_full_25_10_2017.csv'</span><span class=\"token punctuation\">)</span>\ndf<span class=\"token punctuation\">.</span>columns <span class=\"token operator\">=</span> clean_names<span class=\"token punctuation\">(</span><span class=\"token builtin\">list</span><span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">.</span>columns<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">#data wrangling</span>\ndf<span class=\"token punctuation\">[</span><span class=\"token string\">'sector'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>where<span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">[</span><span class=\"token string\">'sector'</span><span class=\"token punctuation\">]</span><span class=\"token operator\">==</span><span class=\"token string\">'Development Bank Limited'</span><span class=\"token punctuation\">,</span> \n                                        <span class=\"token string\">'Development Banks'</span><span class=\"token punctuation\">,</span>np<span class=\"token punctuation\">.</span>where<span class=\"token punctuation\">(</span>\n                        df<span class=\"token punctuation\">[</span><span class=\"token string\">'sector'</span><span class=\"token punctuation\">]</span><span class=\"token operator\">==</span><span class=\"token string\">'Manufacturing And Processing'</span><span class=\"token punctuation\">,</span>\n                                        <span class=\"token string\">'Manufactur &amp; Process'</span><span class=\"token punctuation\">,</span>\n                                        df<span class=\"token punctuation\">[</span><span class=\"token string\">'sector'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># change object data to float type </span>\ndf<span class=\"token punctuation\">[</span><span class=\"token string\">'market_capitalization_rs'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> df<span class=\"token punctuation\">[</span><span class=\"token string\">'market_capitalization_rs'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">.</span>replace<span class=\"token punctuation\">(</span>\n                                            <span class=\"token string\">','</span><span class=\"token punctuation\">,</span><span class=\"token string\">''</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>astype<span class=\"token punctuation\">(</span><span class=\"token string\">'float'</span><span class=\"token punctuation\">)</span><span class=\"token operator\">/</span><span class=\"token number\">1000000000</span>\ndf<span class=\"token punctuation\">[</span><span class=\"token string\">'total_listed_shares'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> df<span class=\"token punctuation\">[</span><span class=\"token string\">'total_listed_shares'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">.</span>replace<span class=\"token punctuation\">(</span>'\n                                              <span class=\"token punctuation\">,</span><span class=\"token string\">','</span><span class=\"token string\">').astype('</span><span class=\"token builtin\">float</span>'<span class=\"token punctuation\">)</span><span class=\"token operator\">/</span><span class=\"token number\">1000000000</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"total market capital is \"</span><span class=\"token punctuation\">,</span> np<span class=\"token punctuation\">.</span><span class=\"token builtin\">sum</span><span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">[</span><span class=\"token string\">'market_capitalization_rs'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"total_share \"</span><span class=\"token punctuation\">,</span> np<span class=\"token punctuation\">.</span><span class=\"token builtin\">sum</span><span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">[</span><span class=\"token string\">'total_listed_shares'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># plot  market cap vs sectors</span>\nplt<span class=\"token punctuation\">.</span>figure<span class=\"token punctuation\">(</span>figsize<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>tick_params<span class=\"token punctuation\">(</span>axis <span class=\"token operator\">=</span> <span class=\"token string\">'both'</span><span class=\"token punctuation\">,</span> which <span class=\"token operator\">=</span> <span class=\"token string\">'major'</span><span class=\"token punctuation\">,</span> labelsize <span class=\"token operator\">=</span> <span class=\"token number\">12</span><span class=\"token punctuation\">)</span>\nsns<span class=\"token punctuation\">.</span>swarmplot<span class=\"token punctuation\">(</span>x<span class=\"token operator\">=</span><span class=\"token string\">'sector'</span><span class=\"token punctuation\">,</span> y<span class=\"token operator\">=</span><span class=\"token string\">'market_capitalization_rs'</span><span class=\"token punctuation\">,</span> \n              data<span class=\"token operator\">=</span>df<span class=\"token punctuation\">,</span> size<span class=\"token operator\">=</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span> linewidth<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>xticks<span class=\"token punctuation\">(</span>rotation<span class=\"token operator\">=</span><span class=\"token operator\">-</span><span class=\"token number\">75</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">(</span>y<span class=\"token operator\">=</span><span class=\"token operator\">-</span><span class=\"token number\">75</span><span class=\"token punctuation\">,</span> x <span class=\"token operator\">=</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> s <span class=\"token operator\">=</span> <span class=\"token string\">'   ©Rpy3.blogspot.com                                                                                                            Source: NEPSE   '</span><span class=\"token punctuation\">,</span>\n    fontsize <span class=\"token operator\">=</span> <span class=\"token number\">14</span><span class=\"token punctuation\">,</span> color <span class=\"token operator\">=</span> <span class=\"token string\">'#f0f0f0'</span><span class=\"token punctuation\">,</span> backgroundcolor <span class=\"token operator\">=</span> <span class=\"token string\">'grey'</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">(</span>x <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> y <span class=\"token operator\">=</span> <span class=\"token number\">155</span><span class=\"token punctuation\">,</span> s <span class=\"token operator\">=</span> <span class=\"token string\">\"Market capital (Billion Rs.) VS Sectors\"</span><span class=\"token punctuation\">,</span>\n               fontsize <span class=\"token operator\">=</span> <span class=\"token number\">26</span><span class=\"token punctuation\">,</span> weight <span class=\"token operator\">=</span> <span class=\"token string\">'bold'</span><span class=\"token punctuation\">,</span> alpha <span class=\"token operator\">=</span> <span class=\"token number\">.75</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">(</span>x <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> y <span class=\"token operator\">=</span> <span class=\"token number\">137</span><span class=\"token punctuation\">,</span> \n               s <span class=\"token operator\">=</span> <span class=\"token triple-quoted-string string\">\"\"\"NEPSE: Total market capital of Rs. 1818.8 billion and \n         total no of shares 4.9 Billion.\\nDominated by banks and insurances.\"\"\"</span><span class=\"token punctuation\">,</span>\n              fontsize <span class=\"token operator\">=</span> <span class=\"token number\">14</span><span class=\"token punctuation\">,</span> alpha <span class=\"token operator\">=</span> <span class=\"token number\">.85</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">(</span>x <span class=\"token operator\">=</span> <span class=\"token number\">0.13</span><span class=\"token punctuation\">,</span> y <span class=\"token operator\">=</span> <span class=\"token number\">126</span><span class=\"token punctuation\">,</span> s <span class=\"token operator\">=</span> <span class=\"token string\">'NTC'</span><span class=\"token punctuation\">,</span> color <span class=\"token operator\">=</span> <span class=\"token string\">'grey'</span><span class=\"token punctuation\">,</span> fontsize <span class=\"token operator\">=</span> <span class=\"token number\">8</span><span class=\"token punctuation\">,</span> \n         weight <span class=\"token operator\">=</span> <span class=\"token string\">'bold'</span><span class=\"token punctuation\">,</span> backgroundcolor <span class=\"token operator\">=</span> <span class=\"token string\">'#f0f0f0'</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">(</span>x <span class=\"token operator\">=</span> <span class=\"token number\">1.13</span><span class=\"token punctuation\">,</span> y <span class=\"token operator\">=</span> <span class=\"token number\">99</span><span class=\"token punctuation\">,</span> s <span class=\"token operator\">=</span> <span class=\"token string\">'Nabil'</span><span class=\"token punctuation\">,</span> color <span class=\"token operator\">=</span> <span class=\"token string\">'grey'</span><span class=\"token punctuation\">,</span> fontsize <span class=\"token operator\">=</span> <span class=\"token number\">8</span><span class=\"token punctuation\">,</span> \n         weight <span class=\"token operator\">=</span> <span class=\"token string\">'bold'</span><span class=\"token punctuation\">,</span> backgroundcolor <span class=\"token operator\">=</span> <span class=\"token string\">'#f0f0f0'</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">(</span>x <span class=\"token operator\">=</span> <span class=\"token number\">2.13</span><span class=\"token punctuation\">,</span> y <span class=\"token operator\">=</span> <span class=\"token number\">61</span><span class=\"token punctuation\">,</span> s <span class=\"token operator\">=</span> <span class=\"token string\">'Nepal Life'</span><span class=\"token punctuation\">,</span> color <span class=\"token operator\">=</span> <span class=\"token string\">'grey'</span><span class=\"token punctuation\">,</span>  fontsize <span class=\"token operator\">=</span> <span class=\"token number\">8</span><span class=\"token punctuation\">,</span> \n         weight <span class=\"token operator\">=</span> <span class=\"token string\">'bold'</span><span class=\"token punctuation\">,</span> backgroundcolor <span class=\"token operator\">=</span> <span class=\"token string\">'#f0f0f0'</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>axhline<span class=\"token punctuation\">(</span>y <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> color <span class=\"token operator\">=</span> <span class=\"token string\">'black'</span><span class=\"token punctuation\">,</span> linewidth <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> alpha <span class=\"token operator\">=</span> <span class=\"token number\">.5</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>xlabel<span class=\"token punctuation\">(</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>ylabel<span class=\"token punctuation\">(</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>savefig<span class=\"token punctuation\">(</span><span class=\"token string\">'plot.png'</span><span class=\"token punctuation\">,</span> dpi <span class=\"token operator\">=</span><span class=\"token number\">144</span><span class=\"token punctuation\">,</span> bbox_inches<span class=\"token operator\">=</span><span class=\"token string\">'tight'</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>close<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Quote from book I am reading.  </p>\n<blockquote>\n<p><em>Everywhere you turn you see Americans(everyone) sacrifice their long-term interests for a short-term reward.</em></p>\n<p><em>― Michael Lewis, Boomerang: Travels in the New Third World</em></p>\n</blockquote>","fields":{"slug":"/posts/nepse-market-cap","tagSlugs":["/tag/nepse/","/tag/visualization/"]},"frontmatter":{"date":"2020-06-01T22:12:03.284Z","description":"Best treat of boring data wrangling process is beautiful visualization that tells the whole story in single glance. NEPSE market cap vs sectors","tags":["nepse","visualization"],"title":"NEPSE: Market Cap Vs Sectors","socialImage":"/media/nepse.png"}}},"pageContext":{"slug":"/posts/nepse-market-cap"}}}